Newtonian Wall-Recon is used
Using TensorFlow version: 2.15.1 , GPU: 4
Number of devices for distributed training: 4
WARNING: The provided batch size is used in each device of the distributed training
n_files_train:6
n_files_validation:2
n_samp_train:21424
n_samp_validation:6420
tfr train:
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file000samples2000_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file000samples2000_002-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file001samples2000_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file001samples2000_002-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file002samples2000_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file002samples2000_002-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file003samples2000_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file003samples2000_002-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file004samples2000_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file004samples2000_002-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file005samples715_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Train/.tfrecords_singlefile_train_dt1157_f32/Ret180_1728x576x864_train_dt1157_velocityn25_yp001-yp015_file005samples715_002-of-002.tfrecords
tfr valid:
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Validation/.tfrecords_singlefile_validation_dt1157_f32/Ret180_1728x576x864_validation_dt1157_velocityn25_yp001-yp015_file000samples2000_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Validation/.tfrecords_singlefile_validation_dt1157_f32/Ret180_1728x576x864_validation_dt1157_velocityn25_yp001-yp015_file000samples2000_002-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Validation/.tfrecords_singlefile_validation_dt1157_f32/Ret180_1728x576x864_validation_dt1157_velocityn25_yp001-yp015_file001samples1210_001-of-002.tfrecords
/mimer/NOBACKUP/groups/kthmech/argb/02_VE/n25/99_dataset/Validation/.tfrecords_singlefile_validation_dt1157_f32/Ret180_1728x576x864_validation_dt1157_velocityn25_yp001-yp015_file001samples1210_002-of-002.tfrecords
180 576

# ====================================================================
#     Summary of the options for the model                            
# ====================================================================

Model name: NN_WallReconfluct1TF2_3NormIn-3Out_1-15_432x432_Ret180_lr0.001_decay20drop0.5_relu-1728047050
Number of samples for training: 21424
Number of samples for validation: 6420
Total number of samples: 27844
Batch size: 16

Data augmentation: False (not implemented in this model)
Initial distribution of parameters: random


Prediction of fluctuation only: True
y- and z-output scaling with the ratio of RMS values : False
Normalized input: True

# ====================================================================
Compiling and training the model for multiple GPU
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                Output Shape                 Param #   Connected to                  
==================================================================================================
 input_data (InputLayer)     [(None, 3, 496, 496)]        0         []                            
                                                                                                  
 conv2d (Conv2D)             (None, 30, 494, 494)         840       ['input_data[0][0]']          
                                                                                                  
 batch_normalization (Batch  (None, 30, 494, 494)         120       ['conv2d[0][0]']              
 Normalization)                                                                                   
                                                                                                  
 activation (Activation)     (None, 30, 494, 494)         0         ['batch_normalization[0][0]'] 
                                                                                                  
 conv2d_1 (Conv2D)           (None, 34, 492, 492)         9214      ['activation[0][0]']          
                                                                                                  
 batch_normalization_1 (Bat  (None, 34, 492, 492)         136       ['conv2d_1[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_1 (Activation)   (None, 34, 492, 492)         0         ['batch_normalization_1[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_2 (Conv2D)           (None, 38, 490, 490)         11666     ['activation_1[0][0]']        
                                                                                                  
 batch_normalization_2 (Bat  (None, 38, 490, 490)         152       ['conv2d_2[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_2 (Activation)   (None, 38, 490, 490)         0         ['batch_normalization_2[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_3 (Conv2D)           (None, 42, 488, 488)         14406     ['activation_2[0][0]']        
                                                                                                  
 batch_normalization_3 (Bat  (None, 42, 488, 488)         168       ['conv2d_3[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_3 (Activation)   (None, 42, 488, 488)         0         ['batch_normalization_3[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_4 (Conv2D)           (None, 46, 486, 486)         17434     ['activation_3[0][0]']        
                                                                                                  
 batch_normalization_4 (Bat  (None, 46, 486, 486)         184       ['conv2d_4[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_4 (Activation)   (None, 46, 486, 486)         0         ['batch_normalization_4[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_5 (Conv2D)           (None, 50, 484, 484)         20750     ['activation_4[0][0]']        
                                                                                                  
 batch_normalization_5 (Bat  (None, 50, 484, 484)         200       ['conv2d_5[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_5 (Activation)   (None, 50, 484, 484)         0         ['batch_normalization_5[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_6 (Conv2D)           (None, 54, 482, 482)         24354     ['activation_5[0][0]']        
                                                                                                  
 batch_normalization_6 (Bat  (None, 54, 482, 482)         216       ['conv2d_6[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_6 (Activation)   (None, 54, 482, 482)         0         ['batch_normalization_6[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_7 (Conv2D)           (None, 58, 480, 480)         28246     ['activation_6[0][0]']        
                                                                                                  
 batch_normalization_7 (Bat  (None, 58, 480, 480)         232       ['conv2d_7[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_7 (Activation)   (None, 58, 480, 480)         0         ['batch_normalization_7[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_8 (Conv2D)           (None, 62, 478, 478)         32426     ['activation_7[0][0]']        
                                                                                                  
 batch_normalization_8 (Bat  (None, 62, 478, 478)         248       ['conv2d_8[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_8 (Activation)   (None, 62, 478, 478)         0         ['batch_normalization_8[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_9 (Conv2D)           (None, 66, 476, 476)         36894     ['activation_8[0][0]']        
                                                                                                  
 batch_normalization_9 (Bat  (None, 66, 476, 476)         264       ['conv2d_9[0][0]']            
 chNormalization)                                                                                 
                                                                                                  
 activation_9 (Activation)   (None, 66, 476, 476)         0         ['batch_normalization_9[0][0]'
                                                                    ]                             
                                                                                                  
 conv2d_10 (Conv2D)          (None, 70, 474, 474)         41650     ['activation_9[0][0]']        
                                                                                                  
 batch_normalization_10 (Ba  (None, 70, 474, 474)         280       ['conv2d_10[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_10 (Activation)  (None, 70, 474, 474)         0         ['batch_normalization_10[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_11 (Conv2D)          (None, 74, 472, 472)         46694     ['activation_10[0][0]']       
                                                                                                  
 batch_normalization_11 (Ba  (None, 74, 472, 472)         296       ['conv2d_11[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_11 (Activation)  (None, 74, 472, 472)         0         ['batch_normalization_11[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_12 (Conv2D)          (None, 78, 470, 470)         52026     ['activation_11[0][0]']       
                                                                                                  
 batch_normalization_12 (Ba  (None, 78, 470, 470)         312       ['conv2d_12[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_12 (Activation)  (None, 78, 470, 470)         0         ['batch_normalization_12[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_13 (Conv2D)          (None, 82, 468, 468)         57646     ['activation_12[0][0]']       
                                                                                                  
 batch_normalization_13 (Ba  (None, 82, 468, 468)         328       ['conv2d_13[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_13 (Activation)  (None, 82, 468, 468)         0         ['batch_normalization_13[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_14 (Conv2D)          (None, 86, 466, 466)         63554     ['activation_13[0][0]']       
                                                                                                  
 batch_normalization_14 (Ba  (None, 86, 466, 466)         344       ['conv2d_14[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_14 (Activation)  (None, 86, 466, 466)         0         ['batch_normalization_14[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_15 (Conv2D)          (None, 86, 464, 464)         66650     ['activation_14[0][0]']       
                                                                                                  
 batch_normalization_15 (Ba  (None, 86, 464, 464)         344       ['conv2d_15[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_15 (Activation)  (None, 86, 464, 464)         0         ['batch_normalization_15[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_16 (Conv2D)          (None, 82, 462, 462)         63550     ['activation_15[0][0]']       
                                                                                                  
 batch_normalization_16 (Ba  (None, 82, 462, 462)         328       ['conv2d_16[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_16 (Activation)  (None, 82, 462, 462)         0         ['batch_normalization_16[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_17 (Conv2D)          (None, 78, 460, 460)         57642     ['activation_16[0][0]']       
                                                                                                  
 batch_normalization_17 (Ba  (None, 78, 460, 460)         312       ['conv2d_17[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_17 (Activation)  (None, 78, 460, 460)         0         ['batch_normalization_17[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_18 (Conv2D)          (None, 74, 458, 458)         52022     ['activation_17[0][0]']       
                                                                                                  
 batch_normalization_18 (Ba  (None, 74, 458, 458)         296       ['conv2d_18[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_18 (Activation)  (None, 74, 458, 458)         0         ['batch_normalization_18[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_19 (Conv2D)          (None, 70, 456, 456)         46690     ['activation_18[0][0]']       
                                                                                                  
 batch_normalization_19 (Ba  (None, 70, 456, 456)         280       ['conv2d_19[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_19 (Activation)  (None, 70, 456, 456)         0         ['batch_normalization_19[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_20 (Conv2D)          (None, 66, 454, 454)         41646     ['activation_19[0][0]']       
                                                                                                  
 batch_normalization_20 (Ba  (None, 66, 454, 454)         264       ['conv2d_20[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_20 (Activation)  (None, 66, 454, 454)         0         ['batch_normalization_20[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_21 (Conv2D)          (None, 62, 452, 452)         36890     ['activation_20[0][0]']       
                                                                                                  
 batch_normalization_21 (Ba  (None, 62, 452, 452)         248       ['conv2d_21[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_21 (Activation)  (None, 62, 452, 452)         0         ['batch_normalization_21[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_22 (Conv2D)          (None, 58, 450, 450)         32422     ['activation_21[0][0]']       
                                                                                                  
 batch_normalization_22 (Ba  (None, 58, 450, 450)         232       ['conv2d_22[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_22 (Activation)  (None, 58, 450, 450)         0         ['batch_normalization_22[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_23 (Conv2D)          (None, 54, 448, 448)         28242     ['activation_22[0][0]']       
                                                                                                  
 batch_normalization_23 (Ba  (None, 54, 448, 448)         216       ['conv2d_23[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_23 (Activation)  (None, 54, 448, 448)         0         ['batch_normalization_23[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_24 (Conv2D)          (None, 50, 446, 446)         24350     ['activation_23[0][0]']       
                                                                                                  
 batch_normalization_24 (Ba  (None, 50, 446, 446)         200       ['conv2d_24[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_24 (Activation)  (None, 50, 446, 446)         0         ['batch_normalization_24[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_25 (Conv2D)          (None, 46, 444, 444)         20746     ['activation_24[0][0]']       
                                                                                                  
 batch_normalization_25 (Ba  (None, 46, 444, 444)         184       ['conv2d_25[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_25 (Activation)  (None, 46, 444, 444)         0         ['batch_normalization_25[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_26 (Conv2D)          (None, 42, 442, 442)         17430     ['activation_25[0][0]']       
                                                                                                  
 batch_normalization_26 (Ba  (None, 42, 442, 442)         168       ['conv2d_26[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_26 (Activation)  (None, 42, 442, 442)         0         ['batch_normalization_26[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_27 (Conv2D)          (None, 38, 440, 440)         14402     ['activation_26[0][0]']       
                                                                                                  
 batch_normalization_27 (Ba  (None, 38, 440, 440)         152       ['conv2d_27[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_27 (Activation)  (None, 38, 440, 440)         0         ['batch_normalization_27[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_28 (Conv2D)          (None, 34, 438, 438)         11662     ['activation_27[0][0]']       
                                                                                                  
 batch_normalization_28 (Ba  (None, 34, 438, 438)         136       ['conv2d_28[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_28 (Activation)  (None, 34, 438, 438)         0         ['batch_normalization_28[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_29 (Conv2D)          (None, 30, 436, 436)         9210      ['activation_28[0][0]']       
                                                                                                  
 batch_normalization_29 (Ba  (None, 30, 436, 436)         120       ['conv2d_29[0][0]']           
 tchNormalization)                                                                                
                                                                                                  
 activation_29 (Activation)  (None, 30, 436, 436)         0         ['batch_normalization_29[0][0]
                                                                    ']                            
                                                                                                  
 conv2d_30 (Conv2D)          (None, 1, 434, 434)          271       ['activation_29[0][0]']       
                                                                                                  
 conv2d_31 (Conv2D)          (None, 1, 434, 434)          271       ['activation_29[0][0]']       
                                                                                                  
 conv2d_32 (Conv2D)          (None, 1, 434, 434)          271       ['activation_29[0][0]']       
                                                                                                  
 lambda (Lambda)             (None, 1, 434, 434)          0         ['conv2d_30[0][0]']           
                                                                                                  
 lambda_1 (Lambda)           (None, 1, 434, 434)          0         ['conv2d_31[0][0]']           
                                                                                                  
 lambda_2 (Lambda)           (None, 1, 434, 434)          0         ['conv2d_32[0][0]']           
                                                                                                  
 output_b1 (Cropping2D)      (None, 1, 432, 432)          0         ['lambda[0][0]']              
                                                                                                  
 output_b2 (Cropping2D)      (None, 1, 432, 432)          0         ['lambda_1[0][0]']            
                                                                                                  
 output_b3 (Cropping2D)      (None, 1, 432, 432)          0         ['lambda_2[0][0]']            
                                                                                                  
==================================================================================================
Total params: 989127 (3.77 MB)
Trainable params: 985647 (3.76 MB)
Non-trainable params: 3480 (13.59 KB)
__________________________________________________________________________________________________
None
Epoch 1/5

Epoch 1: val_output_b1_loss improved from inf to 0.01818, saving model to .logs/NN_WallReconfluct1TF2_3NormIn-3Out_1-15_432x432_Ret180_lr0.001_decay20drop0.5_relu-1728047050/model.ckpt.0001.hdf5
1339/1339 - 560s - loss: 0.0095 - output_b1_loss: 0.0072 - output_b2_loss: 7.1902e-04 - output_b3_loss: 0.0016 - val_loss: 0.0198 - val_output_b1_loss: 0.0182 - val_output_b2_loss: 4.5800e-04 - val_output_b3_loss: 0.0011 - learning_rate: 3.6736e-04 - lr: 0.0010 - 560s/epoch - 418ms/step
Epoch 2/5

Epoch 2: val_output_b1_loss improved from 0.01818 to 0.00431, saving model to .logs/NN_WallReconfluct1TF2_3NormIn-3Out_1-15_432x432_Ret180_lr0.001_decay20drop0.5_relu-1728047050/model.ckpt.0002.hdf5
1339/1339 - 475s - loss: 0.0044 - output_b1_loss: 0.0036 - output_b2_loss: 1.0899e-04 - output_b3_loss: 7.3939e-04 - val_loss: 0.0050 - val_output_b1_loss: 0.0043 - val_output_b2_loss: 6.6196e-05 - val_output_b3_loss: 6.4327e-04 - learning_rate: 2.6240e-04 - lr: 0.0010 - 475s/epoch - 355ms/step
Epoch 3/5

Epoch 3: val_output_b1_loss improved from 0.00431 to 0.00310, saving model to .logs/NN_WallReconfluct1TF2_3NormIn-3Out_1-15_432x432_Ret180_lr0.001_decay20drop0.5_relu-1728047050/model.ckpt.0003.hdf5
1339/1339 - 475s - loss: 0.0033 - output_b1_loss: 0.0028 - output_b2_loss: 7.7409e-05 - output_b3_loss: 4.8367e-04 - val_loss: 0.0038 - val_output_b1_loss: 0.0031 - val_output_b2_loss: 9.4832e-05 - val_output_b3_loss: 5.8899e-04 - learning_rate: 1.9752e-04 - lr: 0.0010 - 475s/epoch - 355ms/step
Epoch 4/5

Epoch 4: val_output_b1_loss did not improve from 0.00310
1339/1339 - 473s - loss: 0.0053 - output_b1_loss: 0.0045 - output_b2_loss: 1.3418e-04 - output_b3_loss: 6.8962e-04 - val_loss: 0.0048 - val_output_b1_loss: 0.0038 - val_output_b2_loss: 1.2593e-04 - val_output_b3_loss: 8.8235e-04 - learning_rate: 1.5696e-04 - lr: 0.0010 - 473s/epoch - 353ms/step
Epoch 5/5

Epoch 5: val_output_b1_loss improved from 0.00310 to 0.00298, saving model to .logs/NN_WallReconfluct1TF2_3NormIn-3Out_1-15_432x432_Ret180_lr0.001_decay20drop0.5_relu-1728047050/model.ckpt.0005.hdf5
1339/1339 - 474s - loss: 0.0039 - output_b1_loss: 0.0031 - output_b2_loss: 7.2542e-05 - output_b3_loss: 7.6711e-04 - val_loss: 0.0038 - val_output_b1_loss: 0.0030 - val_output_b2_loss: 6.9240e-05 - val_output_b3_loss: 7.6800e-04 - learning_rate: 1.2987e-04 - lr: 0.0010 - 474s/epoch - 354ms/step
